{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container-fluid">
    <h1>{{ detallepedido.idpedido }}</h1>
    <ul style="list-style: none;">
        <li>Realizado el <b>{{ detallepedido.idpedido.fecha_pedido }}</b> via <b>{{ detallepedido.idpedido.mediopedido }}</b></li>
        
    </ul>
    <h2>Detalle del pedido</h2>
</div>

<!--Info cliente-->
<div class="card">
<h1>Informacion del Cliente:</h1>
<p><strong>Usuario:</strong> {{ detallepedido.idpedido.idcliente.username }}</p>
<p><strong>Primer Nombre:</strong> {{ detallepedido.idpedido.idcliente.first_name }}</p>
<p><strong>Segundo Nombre:</strong> {{ detallepedido.idpedido.idcliente.segundo_nombre }}</p>
<p><strong>Primer Apellido:</strong> {{ detallepedido.idpedido.idcliente.last_name }}</p>
<p><strong>Segundo Apellido:</strong> {{ detallepedido.idpedido.idcliente.segundo_apellido }}</p>
<p><strong>Rut:</strong> {{ detallepedido.idpedido.idcliente.rut }}</p>
<p><strong>Teléfono:</strong> {{ detallepedido.idpedido.idcliente.telefono }}</p>
<p><strong>Email:</strong> {{ detallepedido.idpedido.idcliente.email }}</p>
<p><strong>Dirección de envío:</strong> {{ detallepedido.idpedido.idcliente.direccion }}</p>
<p><strong>Estado de envío:</strong> {{ detallepedido.idpedido.estado }}</p>
</div>
<p>Gracias por comprar en Te Lo Vendo. Si compraste antes de las 12:00 PM tu pedido será enviado el mismo dia y llegará a tu hogar en 1 día (RM) o 5 días (regiones). El courier de 
    despacho es Starken. Recuerda verificar tu direccion y que esté alguien disponible en tu casa al momento de la entrega.
</p>
<ul>
    <strong>Detalle del pedido:</strong> 
    <li>{{ detallepedido.idproducto.nombre }}</li>
    <li>{{ detallepedido.cantidad }}</li>
    <li>{{ detallepedido.precio }}</li>
    <li>{{ detallepedido.idpedido.precio_total }}</li>
</ul>
<!--Info cliente-->
{% if user.is_staff or user.is_superuser %}
<form method="POST" action="{% url 'detalle_pedido' detallepedido.idpedido.id %}">
    {% csrf_token %}
    <ul>
        <li>
             <label for="estado">Estado:</label>
            <select id="estado" name="estado" onChange="activa_boton(this,this.form.boton)">
                <option value="0" selected>Selecciona un estado</option>
                <option value="Pendiente" {% if pedido.estado == 'Pendiente' %}{% endif %}>Pendiente</option>
                <option value="En Preparación" {% if pedido.estado == 'En Preparación' %}{% endif %}>En preparacion</option>
                <option value="En Despacho" {% if pedido.estado == 'En Despacho' %}{% endif %}>En Despacho</option>
                <option value="Entregado" {% if pedido.estado == 'Entregado' %}{% endif %}>Entregado</option>
            </select>
        </li>
    </ul>
    <input class="btn btn-secondary" type="button" onclick="history.back()" name="Volver atras" value="Volver atras">
    <input class="btn btn-primary" type="submit" name="boton" id="boton" value="Actualizar pedido" disabled=true>
</form>
{% endif %}

<script language="javascript">
    function activa_boton(campo,boton){
       if (campo.value != "0"){
           boton.disabled=false;
       } else {
           boton.disabled=true;
       }
   }
   </script>
{% endblock %}
